<!DOCTYPE html>

<head>
	<title>NZ House Price Index Comparison</title>
	<!-- CSS -->
	<style>
		table {
			width: 50%;
		}

		th,
		td {
			text-align: left;
			padding: 8px;
		}
	</style>

	<!--JavaScript-->
	<script>
		function loadHPITable() {
			let table =
				`<tr>
                    <th>Date</th><th>HPI</th>
				</tr>`;

			//console.log(xmlRecords)
			//console.log(xmlRecords[0])

			// Fetch the data by using TagName 
			for (let i = xmlRecords.length - 25; i < xmlRecords.length; i++) {
				table += "<tr><td>" +
					new Date(xmlRecords[i].getElementsByTagName("Date")[0]
						.textContent).toLocaleString('default', { month: 'long', year: 'numeric' }) + "</td><td>" +
					xmlRecords[i].getElementsByTagName("HPI")[0]
						.textContent + "</td><tr>";
			}

			// Print the xml data in table form
			document.getElementById("id").innerHTML = table;
		}

		function displayResult() {
			var date = document.getElementById("purMonth").value;
			var dateObject = new Date(date)
			var purPrice = document.getElementById("purPrice").value;

			var latestHPIDate = xmlRecords[xmlRecords.length - 1]
				.getElementsByTagName("Date")[0].textContent;
			var latestHPI = xmlRecords[xmlRecords.length - 1]
				.getElementsByTagName("HPI")[0].textContent;


			for (let i = 0; i < xmlRecords.length; i++) {
				iDate = xmlRecords[i].getElementsByTagName("Date")[0].textContent;
				if (date == iDate) {
					hpi = xmlRecords[i].getElementsByTagName("HPI")[0].textContent;
					console.log(hpi)
					break;
				}
				console.log("HPI Not Found");
			}

			var multiplier = latestHPI / hpi;

			var adjPrice = purPrice * multiplier

			var result =
				"A New Zealand property purchased around " + dateObject.toLocaleString('default', { month: 'long', year: 'numeric' }) +
				" for $" + purPrice.toLocaleString() +
				" is like purchasing the property today for $" + adjPrice.toFixed().toLocaleString() +
				".";

			var hpiResult = "More details: the HPI around " + 
				dateObject.toLocaleString('default', { month: 'long', year: 'numeric' }) +
				" was " + hpi + " and the HPI now is " + latestHPI + ". " +
				"We divide the latest HPI by " + hpi + " and that gives us a multiplier of " +
				multiplier.toPrecision(3) + " to calculate how much that would be today based on official house price data.";

			document.getElementById('divResult').textContent = result;
			document.getElementById('hpiResult').textContent = hpiResult;

		}
	</script>
	<script>
		function loadPage() {
			loadHPITable()
		}
	</script>
</head>

<body onload="loadPage()">
	<div id="intro">
		The property was last purchased in
		<input type="month" id="purMonth" name="purMonth" min="1990-03" max="2023-12" required>
		for $
		<input type="number" id="purPrice" name="purPrice" min="1" required>
		<input type="button" value="How much is that in today's market?" onclick="displayResult()">
	</div>
	<br>
	<div id="divResult"></div>
	<br>
	<div id="hpiResult"></div>

	<br><br>
	<div>Last 5 years of HPI data (available data goes back to 1990):</div>
	<table id="id"></table>
</body>

<!-- XML Data-->
<script>
	const xmlRawData =
		`
	<records>
		<record>
			<Date>1990-03</Date>
			<HPI>477</HPI>
		</record>
		<record>
			<Date>1990-06</Date>
			<HPI>480</HPI>
		</record>
		<record>
			<Date>1990-09</Date>
			<HPI>483</HPI>
		</record>
		<record>
			<Date>1990-12</Date>
			<HPI>482</HPI>
		</record>
		<record>
			<Date>1991-03</Date>
			<HPI>479</HPI>
		</record>
		<record>
			<Date>1991-06</Date>
			<HPI>470</HPI>
		</record>
		<record>
			<Date>1991-09</Date>
			<HPI>468</HPI>
		</record>
		<record>
			<Date>1991-12</Date>
			<HPI>466</HPI>
		</record>
		<record>
			<Date>1992-03</Date>
			<HPI>468</HPI>
		</record>
		<record>
			<Date>1992-06</Date>
			<HPI>467</HPI>
		</record>
		<record>
			<Date>1992-09</Date>
			<HPI>470</HPI>
		</record>
		<record>
			<Date>1992-12</Date>
			<HPI>477</HPI>
		</record>
		<record>
			<Date>1993-03</Date>
			<HPI>481</HPI>
		</record>
		<record>
			<Date>1993-06</Date>
			<HPI>482</HPI>
		</record>
		<record>
			<Date>1993-09</Date>
			<HPI>491</HPI>
		</record>
		<record>
			<Date>1993-12</Date>
			<HPI>503</HPI>
		</record>
		<record>
			<Date>1994-03</Date>
			<HPI>520</HPI>
		</record>
		<record>
			<Date>1994-06</Date>
			<HPI>536</HPI>
		</record>
		<record>
			<Date>1994-09</Date>
			<HPI>554</HPI>
		</record>
		<record>
			<Date>1994-12</Date>
			<HPI>572</HPI>
		</record>
		<record>
			<Date>1995-03</Date>
			<HPI>579</HPI>
		</record>
		<record>
			<Date>1995-06</Date>
			<HPI>585</HPI>
		</record>
		<record>
			<Date>1995-09</Date>
			<HPI>599</HPI>
		</record>
		<record>
			<Date>1995-12</Date>
			<HPI>621</HPI>
		</record>
		<record>
			<Date>1996-03</Date>
			<HPI>653</HPI>
		</record>
		<record>
			<Date>1996-06</Date>
			<HPI>663</HPI>
		</record>
		<record>
			<Date>1996-09</Date>
			<HPI>662</HPI>
		</record>
		<record>
			<Date>1996-12</Date>
			<HPI>680</HPI>
		</record>
		<record>
			<Date>1997-03</Date>
			<HPI>696</HPI>
		</record>
		<record>
			<Date>1997-06</Date>
			<HPI>702</HPI>
		</record>
		<record>
			<Date>1997-09</Date>
			<HPI>706</HPI>
		</record>
		<record>
			<Date>1997-12</Date>
			<HPI>715</HPI>
		</record>
		<record>
			<Date>1998-03</Date>
			<HPI>709</HPI>
		</record>
		<record>
			<Date>1998-06</Date>
			<HPI>688</HPI>
		</record>
		<record>
			<Date>1998-09</Date>
			<HPI>677</HPI>
		</record>
		<record>
			<Date>1998-12</Date>
			<HPI>690</HPI>
		</record>
		<record>
			<Date>1999-03</Date>
			<HPI>701</HPI>
		</record>
		<record>
			<Date>1999-06</Date>
			<HPI>705</HPI>
		</record>
		<record>
			<Date>1999-09</Date>
			<HPI>706</HPI>
		</record>
		<record>
			<Date>1999-12</Date>
			<HPI>705</HPI>
		</record>
		<record>
			<Date>2000-03</Date>
			<HPI>705</HPI>
		</record>
		<record>
			<Date>2000-06</Date>
			<HPI>698</HPI>
		</record>
		<record>
			<Date>2000-09</Date>
			<HPI>697</HPI>
		</record>
		<record>
			<Date>2000-12</Date>
			<HPI>697</HPI>
		</record>
		<record>
			<Date>2001-03</Date>
			<HPI>701</HPI>
		</record>
		<record>
			<Date>2001-06</Date>
			<HPI>700</HPI>
		</record>
		<record>
			<Date>2001-09</Date>
			<HPI>706</HPI>
		</record>
		<record>
			<Date>2001-12</Date>
			<HPI>718</HPI>
		</record>
		<record>
			<Date>2002-03</Date>
			<HPI>737</HPI>
		</record>
		<record>
			<Date>2002-06</Date>
			<HPI>752</HPI>
		</record>
		<record>
			<Date>2002-09</Date>
			<HPI>773</HPI>
		</record>
		<record>
			<Date>2002-12</Date>
			<HPI>801</HPI>
		</record>
		<record>
			<Date>2003-03</Date>
			<HPI>842</HPI>
		</record>
		<record>
			<Date>2003-06</Date>
			<HPI>871</HPI>
		</record>
		<record>
			<Date>2003-09</Date>
			<HPI>938</HPI>
		</record>
		<record>
			<Date>2003-12</Date>
			<HPI>1000</HPI>
		</record>
		<record>
			<Date>2004-03</Date>
			<HPI>1041</HPI>
		</record>
		<record>
			<Date>2004-06</Date>
			<HPI>1066</HPI>
		</record>
		<record>
			<Date>2004-09</Date>
			<HPI>1091</HPI>
		</record>
		<record>
			<Date>2004-12</Date>
			<HPI>1125</HPI>
		</record>
		<record>
			<Date>2005-03</Date>
			<HPI>1180</HPI>
		</record>
		<record>
			<Date>2005-06</Date>
			<HPI>1214</HPI>
		</record>
		<record>
			<Date>2005-09</Date>
			<HPI>1251</HPI>
		</record>
		<record>
			<Date>2005-12</Date>
			<HPI>1300</HPI>
		</record>
		<record>
			<Date>2006-03</Date>
			<HPI>1324</HPI>
		</record>
		<record>
			<Date>2006-06</Date>
			<HPI>1337</HPI>
		</record>
		<record>
			<Date>2006-09</Date>
			<HPI>1370</HPI>
		</record>
		<record>
			<Date>2006-12</Date>
			<HPI>1418</HPI>
		</record>
		<record>
			<Date>2007-03</Date>
			<HPI>1479</HPI>
		</record>
		<record>
			<Date>2007-06</Date>
			<HPI>1520</HPI>
		</record>
		<record>
			<Date>2007-09</Date>
			<HPI>1526</HPI>
		</record>
		<record>
			<Date>2007-12</Date>
			<HPI>1531</HPI>
		</record>
		<record>
			<Date>2008-03</Date>
			<HPI>1521</HPI>
		</record>
		<record>
			<Date>2008-06</Date>
			<HPI>1453</HPI>
		</record>
		<record>
			<Date>2008-09</Date>
			<HPI>1423</HPI>
		</record>
		<record>
			<Date>2008-12</Date>
			<HPI>1395</HPI>
		</record>
		<record>
			<Date>2009-03</Date>
			<HPI>1383</HPI>
		</record>
		<record>
			<Date>2009-06</Date>
			<HPI>1407</HPI>
		</record>
		<record>
			<Date>2009-09</Date>
			<HPI>1438</HPI>
		</record>
		<record>
			<Date>2009-12</Date>
			<HPI>1468</HPI>
		</record>
		<record>
			<Date>2010-03</Date>
			<HPI>1469</HPI>
		</record>
		<record>
			<Date>2010-06</Date>
			<HPI>1455</HPI>
		</record>
		<record>
			<Date>2010-09</Date>
			<HPI>1445</HPI>
		</record>
		<record>
			<Date>2010-12</Date>
			<HPI>1444</HPI>
		</record>
		<record>
			<Date>2011-03</Date>
			<HPI>1447</HPI>
		</record>
		<record>
			<Date>2011-06</Date>
			<HPI>1452</HPI>
		</record>
		<record>
			<Date>2011-09</Date>
			<HPI>1474</HPI>
		</record>
		<record>
			<Date>2011-12</Date>
			<HPI>1477</HPI>
		</record>
		<record>
			<Date>2012-03</Date>
			<HPI>1493</HPI>
		</record>
		<record>
			<Date>2012-06</Date>
			<HPI>1510</HPI>
		</record>
		<record>
			<Date>2012-09</Date>
			<HPI>1541</HPI>
		</record>
		<record>
			<Date>2012-12</Date>
			<HPI>1572</HPI>
		</record>
		<record>
			<Date>2013-03</Date>
			<HPI>1609</HPI>
		</record>
		<record>
			<Date>2013-06</Date>
			<HPI>1645</HPI>
		</record>
		<record>
			<Date>2013-09</Date>
			<HPI>1697</HPI>
		</record>
		<record>
			<Date>2013-12</Date>
			<HPI>1715</HPI>
		</record>
		<record>
			<Date>2014-03</Date>
			<HPI>1734</HPI>
		</record>
		<record>
			<Date>2014-06</Date>
			<HPI>1749</HPI>
		</record>
		<record>
			<Date>2014-09</Date>
			<HPI>1778</HPI>
		</record>
		<record>
			<Date>2014-12</Date>
			<HPI>1835</HPI>
		</record>
		<record>
			<Date>2015-03</Date>
			<HPI>1892</HPI>
		</record>
		<record>
			<Date>2015-06</Date>
			<HPI>1956</HPI>
		</record>
		<record>
			<Date>2015-09</Date>
			<HPI>2045</HPI>
		</record>
		<record>
			<Date>2015-12</Date>
			<HPI>2060</HPI>
		</record>
		<record>
			<Date>2016-03</Date>
			<HPI>2136</HPI>
		</record>
		<record>
			<Date>2016-06</Date>
			<HPI>2249</HPI>
		</record>
		<record>
			<Date>2016-09</Date>
			<HPI>2333</HPI>
		</record>
		<record>
			<Date>2016-12</Date>
			<HPI>2355</HPI>
		</record>
		<record>
			<Date>2017-03</Date>
			<HPI>2391</HPI>
		</record>
		<record>
			<Date>2017-06</Date>
			<HPI>2395</HPI>
		</record>
		<record>
			<Date>2017-09</Date>
			<HPI>2422</HPI>
		</record>
		<record>
			<Date>2017-12</Date>
			<HPI>2449</HPI>
		</record>
		<record>
			<Date>2018-03</Date>
			<HPI>2481</HPI>
		</record>
		<record>
			<Date>2018-06</Date>
			<HPI>2481</HPI>
		</record>
		<record>
			<Date>2018-09</Date>
			<HPI>2495</HPI>
		</record>
		<record>
			<Date>2018-12</Date>
			<HPI>2517</HPI>
		</record>
		<record>
			<Date>2019-03</Date>
			<HPI>2526</HPI>
		</record>
		<record>
			<Date>2019-06</Date>
			<HPI>2518</HPI>
		</record>
		<record>
			<Date>2019-09</Date>
			<HPI>2565</HPI>
		</record>
		<record>
			<Date>2019-12</Date>
			<HPI>2633</HPI>
		</record>
		<record>
			<Date>2020-03</Date>
			<HPI>2722</HPI>
		</record>
		<record>
			<Date>2020-06</Date>
			<HPI>2696</HPI>
		</record>
		<record>
			<Date>2020-09</Date>
			<HPI>2839</HPI>
		</record>
		<record>
			<Date>2020-12</Date>
			<HPI>3081</HPI>
		</record>
		<record>
			<Date>2021-03</Date>
			<HPI>3379</HPI>
		</record>
		<record>
			<Date>2021-06</Date>
			<HPI>3495</HPI>
		</record>
		<record>
			<Date>2021-09</Date>
			<HPI>3704</HPI>
		</record>
		<record>
			<Date>2021-12</Date>
			<HPI>3920</HPI>
		</record>
		<record>
			<Date>2022-03</Date>
			<HPI>3846</HPI>
		</record>
		<record>
			<Date>2022-06</Date>
			<HPI>3681</HPI>
		</record>
		<record>
			<Date>2022-09</Date>
			<HPI>3548</HPI>
		</record>
		<record>
			<Date>2022-12</Date>
			<HPI>3484</HPI>
		</record>
		<record>
			<Date>2023-03</Date>
			<HPI>3382</HPI>
		</record>
		<record>
			<Date>2023-06</Date>
			<HPI>3349</HPI>
		</record>
		<record>
			<Date>2023-09</Date>
			<HPI>3404</HPI>
		</record>
		<record>
			<Date>2023-12</Date>
			<HPI>3458</HPI>
		</record>
	</records>
	`;

	const parser = new DOMParser();
	const xmlData = parser.
		parseFromString(xmlRawData, "text/xml");
	const xmlRecords = xmlData.getElementsByTagName("record")
	//console.log(xmlRecords)
</script>

</html>